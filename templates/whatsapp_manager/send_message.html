<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send WhatsApp Message</title>
</head>
<body>
    <h1>Send WhatsApp Message</h1>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}

        <h3>Select Users:</h3>
        <label>
            <input type="checkbox" id="select_all" onclick="toggleSelectAll()"> Select All
        </label>
        <ul>
            {% for user in users %}
                <li>
                    <label>
                        <input type="checkbox" name="selected_users" value="{{ user.id }}" class="user-checkbox">
                        {{ user.first_name }} {{ user.last_name }} ({{ user.whatsapp_num }})
                    </label>
                </li>
            {% endfor %}
        </ul>

        <button type="submit">Send Message</button>
    </form>

    <script>
        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.user-checkbox');
            const selectAllCheckbox = document.getElementById('select_all');
            checkboxes.forEach(cb => cb.checked = selectAllCheckbox.checked);
        }
    </script>
</body>
</html>
